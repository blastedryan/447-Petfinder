<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
    <meta charset="UTF-8">
    <title>Title</title>
    <link href='https://fonts.googleapis.com/css?family=Archivo Narrow' rel='stylesheet'>
    <style>
        body{
            font-family: 'Archivo Narrow',"Times New Roman",serif;font-size: 22px;
        }

        #map {
            position: absolute;
	}


    .mapboxgl-popup {
        max-width: 400px;
        font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    }


	.mapboxgl-popup-content {
	    text-align: center;
	    font-family: 'Open Sans', sans-serif;

	}

	img{
            width: 100px;
            height: auto;
        }
    </style>
</head>
<body>
    <div class = "jumbotron jumbotron-fluid text-center">
        <div class = "container">
            <h1>Petfinder Geospatial Search</h1>
            <p>Search for pets in your area based on your specifications</p>
        </div>
    </div>
    <h3 class = "text-center">Searching for: Birds</h3>
    <div id="accordion">
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingOne">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
          Species
        </button>
      </h5>
    </div>

    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">
          <input type = "checkbox" id = "Button" name = "Button">
          <label for = "Button">Button-Quail</label>
          <input type = "checkbox" id = "chicken" name = "chicken">
          <label for = "chicken">Chicken</label>
          <input type = "checkbox" id = "Dove" name = "dove">
          <label for = "Dove">Dove</label>
          <input type = "checkbox" id = "duck" name = "duck">
          <label for = "duck">Duck</label>
          <input type = "checkbox" id = "emu" name = "emu">
          <label for = "emu">Emu</label>
          <input type = "checkbox" id = "finch" name = "finch">
          <label for = "finch">Finch</label>
          <input type = "checkbox" id = "goose" name = "goose">
          <label for = "goose">Goose</label>
          <input type = "checkbox" id = "guinea" name = "guinea">
          <label for = "guinea">Guinea Fowl</label>
          <input type = "checkbox" id = "ostrich" name = "ostrich?">
          <label for = "ostrich">Ostrich</label>
          <input type = "checkbox" id = "parakeet" name = "parakeet">
          <label for = "parakeet">Parakeet</label>
          <input type = "checkbox" id = "parrot" name = "parrot">
          <label for = "parrot">Parrot</label>
          <input type = "checkbox" id = "peacock" name = "peacock">
          <label for = "peacock">Peacock/Peafowl</label>
          <input type = "checkbox" id = "pheasant" name = "pheasant">
          <label for = "pheasant">Pheasant</label>
          <input type = "checkbox" id = "Quail" name = "Quail">
          <label for = "Quail">Quail</label>
          <input type = "checkbox" id = "Rhea" name = "Rhea">
          <label for = "Rhea">Rhea</label>
          <input type = "checkbox" id = "swan" name = "swan">
          <label for = "swan">Swan</label>
          <input type = "checkbox" id = "toucan" name = "toucan">
          <label for = "toucan">Toucan</label>
          <input type = "checkbox" id = "turkey" name = "turkey">
          <label for = "turkey">Turkey</label>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Breed
        </button>
      </h5>
    </div>

    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">
          <label for="Breed">Breed</label>
          <input type="text" id = "Breed" name = "Breed">
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          Age
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">
          <label for="Age">Age</label>
          <select name = "age" id = "Age">
              <option value = "Baby">Baby</option>
              <option value = "Young">Young</option>
              <option value = "Adult">Adult</option>
              <option value = "Senior">Senior</option>
          </select>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingFour">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
          Size
        </button>
      </h5>
    </div>
    <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
      <div class="card-body">
          Size:
          <input type="checkbox" id = "small" name = "small">
          <label for="small">Small</label>
          <input type="checkbox" id = "mediumSize" name = "medium">
          <label for="mediumSize">Medium</label>
          <input type="checkbox" id = "large" name = "large">
          <label for="large">Large</label>
          <input type = "checkbox" id = "xlarge" name = "xlarge">
          <label for ="xlarge">Extra Large</label>
      </div>
    </div>
  </div>
    <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingFive">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
          Gender
        </button>
      </h5>
    </div>

    <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
      <div class="card-body">
          Gender:
          <input type="checkbox" id = "male" name = "male">
          <label for="male">Male</label>
          <input type = "checkbox" id = "female" name = "female">
          <label for="female">Female</label>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingSix">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
          Good With
        </button>
      </h5>
    </div>
    <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#accordion">
      <div class="card-body">
          Good With:
          <input type = "checkbox" id = "kids" name = "kids">
          <label for="kids">Kids</label>
          <input type = "checkbox" id = "dogs" name = "dogs">
          <label for="dogs">Dogs</label>
          <input type = "checkbox" id = "other cats" name = "other cate">
          <label for = "other cats">Other Cats</label>
      </div>
    </div>
  </div>


    <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingEight">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
             Color
        </button>
      </h5>
    </div>

    <div id="collapseEight" class="collapse" aria-labelledby="headingEight" data-parent="#accordion">
      <div class="card-body">
           Color:
            <input type = "checkbox" id = "Black" name = "Black">
            <label for = "Black">Black</label>
            <input type = "checkbox" id = "Blue" name = "Blue">
            <label for="Blue">Blue</label>
            <input type = "checkbox" id = "Brown" name = "Brown">
            <label for ="Brown">Brown</label>
            <input type = "checkbox" id = "Buff" name = "buff">
            <label for = "Buff">Buff</label>
            <input type = "checkbox" id = "Gray" name = "Gray">
            <label for = "Gray">Gray</label>
            <input type = "checkbox" id = "Green" name = "Green">
            <label for = "Green">Green</label>
            <input type = "checkbox" id = "olive" name = "olive">
            <label for = "olive">Olive</label>
            <input type = "checkbox" id = "Orange" name = "Orange">
            <label for = "Orange">Orange</label>
            <input type = "checkbox" id = "Pink" name = "Pink">
            <label for = "Pink">Pink</label>
            <input type = "checkbox" id = "Purple" name = "Purple">
            <label for = "Purple">Purple</label>
            <input type = "checkbox" id = "red" name = "red">
            <label for = "red">Red</label>
            <input type = "checkbox" id = "rust" name = "rust">
            <label for = "rust">Rust/Rufous</label>
            <input type = "checkbox" id = "tan" name = "tan">
            <label for = "tan">Tan</label>
            <input type = "checkbox" id = "white" name = "white">
            <label for = "white">White</label>
            <input type = "checkbox" id = "yellow" name = "yellow">
            <label for = "yellow">Yellow</label>


      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingNine">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseNine" aria-expanded="false" aria-controls="collapseNine">
            Care & Behavior
        </button>
      </h5>
    </div>
    <div id="collapseNine" class="collapse" aria-labelledby="headingNine" data-parent="#accordion">
      <div class="card-body">
          Care & Behavior
          <input type = "checkbox" id = "House-Trained" name = "House Trained">
          <label for="House-Trained">House-Trained</label>

          <input type = "checkbox" id = "Special Needs" name = "Special Needs">
          <label for = "Special Needs">Special Needs</label>
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingTen">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTen" aria-expanded="false" aria-controls="collapseTen">
            Days on Petfinder
        </button>
      </h5>
    </div>
    <div id="collapseTen" class="collapse" aria-labelledby="headingNine" data-parent="#accordion">
      <div class="card-body">
          Days on Petfinder:
          <input type = "radio" id = "any" name = "any">
          <label for = "any">Any</label>
          <input type = "radio" id = "oneDay" name = "one">
          <label for = "oneDay">1</label>
          <input type = "radio" id = "oneWeek" name = "oneweek">
          <label for = "oneWeek">7</label>
          <input type = "radio" id = "twoWeek" name = "twoWeek">
          <label for = "twoWeek">14</label>
          <input type = "radio" id = "Longer" name = "longer">
          <label for = "Longer">30+</label>
      </div>
    </div>
  </div>
    <div class="card">
    <div class="card-header text-center bg-dark text-white" id="headingEleven">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseEleven" aria-expanded="false" aria-controls="collapseEleven">
            Shelter or Rescue
        </button>
      </h5>
    </div>

    <div id="collapseEleven" class="collapse" aria-labelledby="headingEleven" data-parent="#accordion">
      <div class="card-body">
            Name of Shelter or Rescue Organization:
            <input type = "text" class = "form-control" aria-label = "small" placeholder = "Please Enter Organization's Name">
      </div>
    </div>
  </div>
</div>
 <button type="submit">Search</button>

    <div class = "container">
      <h2 class = "text-center">
	Pets within 10 mile radius
      </h2>

      <div id='map' style='width: 800px; height: 600px;'></div>
    </div>

    {{ the_json|json_script:"geodata" }}

    <script>

      var api_key = "{{MAPBOX_API_KEY}}"

      mapboxgl.accessToken = api_key

      var geodata = JSON.parse(document.getElementById('geodata').textContent);
      
      var map = new mapboxgl.Map({
	  container: 'map',
	  style: 'mapbox://styles/mapbox/streets-v11',
	  center:[-77.04, 38.907],
	  zoom: 11.5
      });



      map.on('load', function () {
	  map.loadImage(
	      'https://docs.mapbox.com/mapbox-gl-js/assets/custom_marker.png',

	      // Add an image to use as a custom marker
	      function (error, image) {
		  if (error) throw error;
		  map.addImage('custom-marker', image);

		  map.addSource('pets', {
		      type: 'geojson',
		      data:geodata,
		      cluster: true,
		      clusterMaxZoom: 14, // Max zoom to cluster points on
		      clusterRadius: 100 // Radius of each cluster when clustering points (defaults to 50)
		  });




		  map.addLayer({
		      id: 'clusters',
		      type: 'circle',
		      source: 'pets',
		      filter: ['has', 'point_count'],
		      paint: {
			  // Use step expressions (https://docs.mapbox.com/mapbox-gl-js/style-spec/#expressions-step)
			  // with three steps to implement three types of circles:
			  //   * Blue, 20px circles when point count is less than 100
			  //   * Yellow, 30px circles when point count is between 100 and 750
			  //   * Pink, 40px circles when point count is greater than or equal to 750
			  'circle-color': [
			      'step',
			      ['get', 'point_count'],
			      '#51bbd6',
			      3,
			      '#f1f075',
			      10,
			      '#f28cb1'
			  ],
			  'circle-radius': [
			      'step',
			      ['get', 'point_count'],
			      20,
			      100,
			      30,
			      750,
			      40
			  ]
		      }
		  });




		  map.addLayer({
		      id: 'cluster-count',
		      type: 'symbol',
		      source: 'pets',
		      filter: ['has', 'point_count'],
		      layout: {
			  'text-field': '{point_count_abbreviated}',
			  'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],
			  'text-size': 12
		      }
		  });


		  // Add a layer showing the places.
		  map.addLayer({
		      'id': 'pets_found',
		      'type': 'symbol',
		      'source': 'pets',
		      'filter':['!', ['has', 'point_count']],
		      'layout': {
			  'icon-image': 'custom-marker',
			  'icon-allow-overlap': true
		      }
		  });



	      }
	  );

	  // Create a popup, but don't add it to the map yet.
	  var popup = new mapboxgl.Popup({
	      closeButton: false,
	      closeOnClick: false
	  });
	  
	  map.on('mouseenter', 'pets_found', function (e) {
	      // Change the cursor style as a UI indicator.
	      map.getCanvas().style.cursor = 'pointer';
	      
	      var coordinates = e.features[0].geometry.coordinates.slice();
	      var description = e.features[0].properties.description;
	      var image = e.features[0].properties.image;

	      // If the map is zoomed out such that multiple
	      // copies of the feature are visible, the popup appears
	      // over the copy being pointed to.
	      while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
		  coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
	      }
	      
	      // Populate the popup and set its coordinates
	      // based on the feature found.
	      popup.setLngLat(coordinates).setHTML('<p><img src='+image+'></p>'+description).addTo(map);
	  });
	  
	  map.on('mouseleave', 'pets_found', function () {
	      map.getCanvas().style.cursor = '';
	      popup.remove();
	  });
      });





    </script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
</body>
</html>
